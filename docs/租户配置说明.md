# BTC-SaaS MES系统 租户配置说明

## 📋 概述

本文档详细说明了BTC-SaaS MES系统的三个租户配置，包括用户群体、权限设置、功能模块和数据隔离策略。

---

## 🏢 租户架构

### 1. 租户概览

| 租户代码 | 租户名称 | 租户类型 | 用户规模 | 主要用途 |
|---------|----------|----------|----------|----------|
| `UK_HEAD` | 英国总公司 | ENTERPRISE | 20-50人 | 数据查看和分析 |
| `INERT` | 内网用户 | ENTERPRISE | 100-300人 | MES系统主要用户 |
| `SUPPLIER` | 供应商群体 | SMALL_MEDIUM | 50-100人 | 外部合作伙伴 |

---

## 🎯 租户详细配置

### 1. UK_HEAD - 英国总公司

#### 1.1 基本信息
- **租户代码**: `UK_HEAD`
- **租户名称**: 英国总公司
- **租户类型**: ENTERPRISE
- **规模**: Large
- **订阅计划**: ENTERPRISE
- **联系人**: IT Administrator (it@ukhead.com)
- **行业**: Manufacturing

#### 1.2 用户群体特征
- **主要用户**: 英国领导和IT部门
- **用户类型**: 大部分为只读用户
- **主要功能**: 数据查看和分析
- **访问模式**: 主要进行数据监控和决策支持

#### 1.3 部门结构
- **IT部门** (`UK_IT`)
  - 管理员: UK IT管理员
  - 负责系统维护和技术支持
- **领导层** (`UK_LEADERSHIP`)
  - 管理员: 英国领导
  - 负责战略决策和数据分析

#### 1.4 角色权限体系
```
ROLE_UK_ADMIN (英国管理员)
├── 数据查看权限 (PERM_UK_VIEW)
├── 报表查看权限 (PERM_UK_REPORT)
└── 继承: 所有下级角色权限

ROLE_UK_VIEWER (英国查看者)
├── 数据查看权限 (PERM_UK_VIEW)
└── 只读访问所有数据

ROLE_UK_IT (英国IT)
├── 继承ROLE_UK_ADMIN权限
├── 系统管理权限
└── 技术支持权限

ROLE_UK_LEADER (英国领导)
├── 继承ROLE_UK_VIEWER权限
├── 报表查看权限
└── 决策支持数据访问
```

#### 1.5 功能模块
- **数据看板** (`/uk/dashboard`)
  - 实时生产数据监控
  - 关键指标展示
  - 趋势分析图表
- **报表中心** (`/uk/reports`)
  - 生产报表
  - 质量报表
  - 财务报表
  - 自定义报表

### 2. INERT - 内网用户

#### 2.1 基本信息
- **租户代码**: `INERT`
- **租户名称**: 内网用户
- **租户类型**: ENTERPRISE
- **规模**: Medium
- **订阅计划**: STANDARD
- **联系人**: MES Administrator (admin@inert.com)
- **行业**: Manufacturing

#### 2.2 用户群体特征
- **主要用户**: MES系统的主要用户群体
- **当前规模**: 约100人
- **扩展能力**: 未来可扩展至300人
- **主要功能**: 日常生产操作、质量管理、仓库管理

#### 2.3 部门结构
- **生产部门** (`PRODUCTION`)
  - 管理员: 内网管理员
  - 负责生产计划、工单管理、工艺执行
- **质量部门** (`QUALITY`)
  - 负责检验管理、质量控制、质量分析
- **仓库部门** (`WAREHOUSE`)
  - 负责库存管理、出入库操作、盘点管理
- **维护部门** (`MAINTENANCE`)
  - 负责设备维护、预防性维护、故障处理

#### 2.4 角色权限体系
```
ROLE_INERT_ADMIN (内网管理员)
├── 生产管理权限 (PERM_INERT_PRODUCTION)
├── 质量管理权限 (PERM_INERT_QUALITY)
├── 仓库管理权限 (PERM_INERT_WAREHOUSE)
├── 维护管理权限 (PERM_INERT_MAINTENANCE)
└── 继承: 所有下级角色权限

ROLE_INERT_MANAGER (内网经理)
├── 生产管理权限 (PERM_INERT_PRODUCTION)
├── 质量管理权限 (PERM_INERT_QUALITY)
├── 数据范围: 本部门及子部门
└── 继承: 下级角色权限

ROLE_INERT_OPERATOR (内网操作员)
├── 生产管理权限 (PERM_INERT_PRODUCTION)
├── 数据范围: 本部门
└── 日常操作权限

ROLE_INERT_VIEWER (内网查看员)
├── 只读访问权限
├── 数据范围: 本部门
└── 报表查看权限

ROLE_INERT_HR (内网HR)
├── 人事管理权限
├── 员工信息管理
└── 数据范围: 本部门

ROLE_INERT_FINANCE (内网财务)
├── 财务数据访问权限
├── 成本分析权限
└── 数据范围: 本部门
```

#### 2.5 功能模块
- **生产管理** (`/production`)
  - 工单管理 (`/production/work-order`)
  - 工艺路线管理
  - 生产计划管理
  - 首件验证管理
- **质量管理** (`/quality`)
  - 检验管理 (`/quality/inspection`)
  - 质量控制
  - 缺陷管理
  - 质量分析
- **仓库管理** (`/warehouse`)
  - 库存管理 (`/warehouse/inventory`)
  - 出入库管理
  - 盘点管理
  - 备料管理
- **维护管理** (`/maintenance`)
  - 设备维护
  - 预防性维护
  - 故障处理
  - 维护计划

### 3. SUPPLIER - 供应商群体

#### 3.1 基本信息
- **租户代码**: `SUPPLIER`
- **租户名称**: 供应商群体
- **租户类型**: SMALL_MEDIUM
- **规模**: Medium
- **订阅计划**: BASIC
- **联系人**: Supplier Manager (supplier@company.com)
- **行业**: Supply Chain

#### 3.2 用户群体特征
- **主要用户**: 外部合作伙伴
- **包含类型**: 模具供应商、原材料供应商
- **主要功能**: 供应商协同、数据共享、质量反馈
- **访问模式**: 受限访问，主要查看相关数据

#### 3.3 部门结构
- **模具供应商** (`MOLD_SUPPLIER`)
  - 管理员: 供应商管理员
  - 负责模具状态管理、发货协同
- **原材料供应商** (`RAW_MATERIAL`)
  - 负责原材料供应、质量反馈
  - IQC状态同步

#### 3.4 角色权限体系
```
ROLE_SUPPLIER_ADMIN (供应商管理员)
├── 模具管理权限 (PERM_SUPPLIER_MOLD)
├── 原材料管理权限 (PERM_SUPPLIER_RAW)
└── 继承: 所有下级角色权限

ROLE_SUPPLIER_MOLD (模具供应商)
├── 模具管理权限 (PERM_SUPPLIER_MOLD)
├── 模具状态查看和更新
├── 发货信息管理
└── 数据范围: 本部门

ROLE_SUPPLIER_RAW (原材料供应商)
├── 原材料管理权限 (PERM_SUPPLIER_RAW)
├── 原材料供应信息
├── 质量反馈管理
└── 数据范围: 本部门
```

#### 3.5 功能模块
- **模具管理** (`/supplier/mold`)
  - 模具状态管理
  - 发货协同
  - 模具维护信息
- **原材料管理** (`/supplier/raw-material`)
  - 原材料供应信息
  - 质量反馈
  - IQC状态同步

---

## 🔐 数据隔离策略

### 1. 租户级隔离
- **数据隔离**: 所有业务数据通过`tenant_id`进行隔离
- **用户隔离**: 用户只能访问所属租户的数据
- **权限隔离**: 权限配置按租户独立管理

### 2. 站点级隔离（可选）
- **多站点支持**: 通过`site_id`支持同一租户下的多站点
- **数据范围**: 可配置站点级别的数据访问范围

### 3. 部门级隔离
- **部门数据范围**: 通过角色配置控制部门数据访问范围
- **继承机制**: 上级部门可访问下级部门数据
- **数据权限**: ALL/DEPT_AND_CHILD/DEPT/SELF

---

## 📊 权限控制矩阵

| 租户 | 角色 | 生产管理 | 质量管理 | 仓库管理 | 维护管理 | 模具管理 | 原材料管理 | 数据查看 | 报表查看 |
|------|------|----------|----------|----------|----------|----------|------------|----------|----------|
| UK_HEAD | 管理员 | ❌ | ❌ | ❌ | ❌ | ❌ | ❌ | ✅ | ✅ |
| UK_HEAD | 查看者 | ❌ | ❌ | ❌ | ❌ | ❌ | ❌ | ✅ | ❌ |
| UK_HEAD | IT | ❌ | ❌ | ❌ | ❌ | ❌ | ❌ | ✅ | ✅ |
| UK_HEAD | 领导 | ❌ | ❌ | ❌ | ❌ | ❌ | ❌ | ✅ | ✅ |
| INERT | 管理员 | ✅ | ✅ | ✅ | ✅ | ❌ | ❌ | ✅ | ✅ |
| INERT | 经理 | ✅ | ✅ | ❌ | ❌ | ❌ | ❌ | ✅ | ✅ |
| INERT | 操作员 | ✅ | ❌ | ❌ | ❌ | ❌ | ❌ | ✅ | ❌ |
| INERT | 查看员 | ❌ | ❌ | ❌ | ❌ | ❌ | ❌ | ✅ | ❌ |
| SUPPLIER | 管理员 | ❌ | ❌ | ❌ | ❌ | ✅ | ✅ | ✅ | ❌ |
| SUPPLIER | 模具供应商 | ❌ | ❌ | ❌ | ❌ | ✅ | ❌ | ✅ | ❌ |
| SUPPLIER | 原材料供应商 | ❌ | ❌ | ❌ | ❌ | ❌ | ✅ | ✅ | ❌ |

---

## 🚀 扩展规划

### 1. 用户规模扩展
- **UK_HEAD**: 当前20-50人，预计稳定在50人以内
- **INERT**: 当前100人，规划扩展至300人
- **SUPPLIER**: 当前50-100人，可根据业务需要扩展

### 2. 功能模块扩展
- **UK_HEAD**: 增加高级分析功能、自定义报表
- **INERT**: 增加更多生产模块、质量模块、维护模块
- **SUPPLIER**: 增加供应商评价、协同功能

### 3. 集成扩展
- **ERP集成**: 与现有ERP系统深度集成
- **第三方系统**: 支持更多第三方系统接入
- **移动端支持**: 开发移动端应用

---

## 📋 部署建议

### 1. 环境配置
- **数据库**: 建议为每个租户配置独立的数据库实例
- **缓存**: 使用Redis进行会话和缓存管理
- **负载均衡**: 支持多实例部署和负载均衡

### 2. 安全配置
- **网络隔离**: 建议使用VPN或专线连接
- **访问控制**: 实施严格的访问控制和审计
- **数据加密**: 敏感数据加密存储和传输

### 3. 监控告警
- **性能监控**: 实时监控系统性能
- **业务监控**: 监控关键业务指标
- **异常告警**: 异常情况及时告警

---

## 📚 总结

通过三个租户的精细化配置，BTC-SaaS MES系统能够满足不同用户群体的需求：

1. **UK_HEAD**: 为英国总公司的领导和IT部门提供数据查看和分析能力
2. **INERT**: 为内网用户提供完整的MES功能，支持日常生产操作
3. **SUPPLIER**: 为供应商群体提供协同功能，支持外部合作伙伴

这种多租户架构既保证了数据隔离和安全性，又提供了灵活的权限管理和功能扩展能力。
